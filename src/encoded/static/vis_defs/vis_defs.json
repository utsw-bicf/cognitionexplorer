# This file contains standard json (no extra commas) with the exception that '#' comments are OK.

# vis_defs are "Visualization Definitions" which define the default viusualization settings for
#          a given experiment type.  Initially created to enable visualization on the UCSC
#          browser, th definitions can be extended for alternate visualization tools.
# vis_type, a short identifier, is the unique vis_def key.  An experiment's vis_type and vis_def
#          vis_def is determined by a set of rules.
# "rule"   If the vis_def contains a 'rule' property, then this alone defines the rule for
#          assigning a vis_type/vis_def to a dataset.  More complicated rules for some vis_types
#          are hard-coded into visualization.py.  If a datasets' vis_type cannot be determined,
#          it is considered "opaque" and will used the default vis_def.

# "live group" defs are keyed by tag and are the transformed in memory version of static defs
# title: (required) same as the static group's key
# groups: (if appropriate) { subgroups keyed by subgroup tag }
# group_order: (if appropriate) [ ordered list of subgroup tags ]

{
"opaque": {  # COMPOSITE_VIS_DEFS_DEFAULT = {
    "assay_composite": {
        "longLabel":  "Collection of Miscellaneous ENCODE datasets",
        "shortLabel": "ENCODE Misc."
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
     #"allButtonPair": "off"
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Peaks", "Signals" ],
        "groups": {
            "Peaks": {
                "tag": "PK",
                "visibility": "dense",
                "type": "bigBed",
                "spectrum": "on"
            },
            "Signals": {
                "tag": "SIG",
                "visibility": "full",
                "type": "bigWig",
                "autoScale": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers"
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY", "Targets": "dimX", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}",
                        "combined_title": "Pooled"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}" } }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}", "url_mask": "targets/{target.name}" } }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"LRNA": { # LRNA_COMPOSITE_VIS_DEFS = {
    "assay_composite": {
        "longLabel":  "Collection of ENCODE long-RNA-seq experiments",
        "shortLabel": "ENCODE long-RNA-seq"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views": {
        "tag": "view",
        "group_order": [ "Signal of unique reads", "Signal of all reads",
                        "Plus signal of unique reads", "Minus signal of unique reads",
                        "Plus signal of all reads", "Minus signal of all reads" ],
        "groups": {
            "Signal of unique reads": {
                "tag": "SIGBL",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of unique reads" ]
            },
            "Signal of all reads": {
                "tag": "SIGBM",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of all reads" ]
            },
            "Minus signal of unique reads": {
                "tag": "SIGLR",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of unique reads" ]
            },
            "Plus signal of unique reads": {
                "tag": "SIGLF",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of unique reads" ]
            },
            "Plus signal of all reads": {
                "tag": "SIGMF",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of all reads" ]
            },
            "Minus signal of all reads": {
                "tag": "SIGMR",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of all reads" ]
            }
        }
    },
    "other_groups": {
        "dimensions": { "Biosample": "dimY", "Targets": "dimX", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                "replicate": {
                    "title_mask": "Replicate_{replicate_number}"
                    #"combined_title": "Pooled", # "Combined"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}", "url_mask": "targets/{target.name}" } }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"tkRNA": { # TKRNA_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' in ['shRNA knockdown followed by RNA-seq','siRNA knockdown followed by RNA-seq','CRISPR genome editing followed by RNA-seq']",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE targeted knockdowns RNA-seq experiments",
        "shortLabel": "ENCODE knockdown RNA-seq"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates",  "Assay", "Views" ],
    "Views": {
        "tag": "view",
        "group_order": [ "Signal of unique reads", "Signal of all reads", "Plus signal of unique reads", "Minus signal of unique reads", "Plus signal of all reads", "Minus signal of all reads" ],
        "groups": {
            "Signal of unique reads": {
                "tag": "SIGBL",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of unique reads" ]
            },
            "Signal of all reads": {
                "tag": "SIGBM",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of all reads" ]
            },
            "Plus signal of unique reads": {
                "tag": "SIGLF",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of unique reads" ]
            },
            "Minus signal of unique reads": {
                "tag": "SIGLR",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of unique reads" ]
            },
            "Plus signal of all reads": {
                "tag": "SIGMF",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of all reads" ]
            },
            "Minus signal of all reads": {
                "tag": "SIGMR",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of all reads" ]
            }
        }
    },
    "other_groups": {
        "dimensions": { "Biosample": "dimY", "Targets": "dimX", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "group_order": "sort",
                "groups": {
                "replicate": {
                    "title_mask": "Replicate_{replicate_number}", # Optional
                    "combined_title": "Pooled" # "Combined"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}" } }
            },
            "Assay": {
                "tag": "Assay",
                "groups": { "one": { "title_mask": "{target.title}" } }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"SRNA": { # SRNA_COMPOSITE_VIS_DEFS = {
    "assay_composite": {
        "longLabel":  "Collection of ENCODE small-RNA-seq experiments",
        "shortLabel": "ENCODE small-RNA-seq"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views": {
        "tag": "view",
        "group_order": [ "Plus signal of unique reads", "Minus signal of unique reads", "Plus signal of all reads", "Minus signal of all reads" ],
        "groups": {
            "Minus signal of unique reads": {
                "tag": "SIGLR",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of unique reads" ]
            },
            "Plus signal of unique reads": {
                "tag": "SIGLF",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of unique reads" ]
            },
            "Plus signal of all reads": {
                "tag": "SIGMF",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of all reads" ]
            },
            "Minus signal of all reads": {
                "tag": "SIGMR",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of all reads" ]
            }
        }
    },
    "other_groups": {
        "dimensions": { "Biosample": "dimY", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                "replicate": {
                    "title_mask": "Replicate_{replicate_number}" # Optional
                    #"combined_title": "Pooled" # "Combined"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"TSS": { # RAMPAGE_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' in ['RAMPAGE','CAGE']",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE RAMPAGE/CAGE experiments",
        "shortLabel": "ENCODE RAMPAGE/CAGE"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} - {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Replicated TSSs", "TSSs",
                         "Signal of unique reads", "Signal of all reads",
                         "Plus signal of unique reads", "Minus signal of unique reads",
                         "Plus signal of all reads", "Minus signal of all reads" ],
        "groups": {
          "Replicated TSSs": {
                "tag": "ARTSS",
                "visibility": "dense",
                "spectrum": "on",
                "type": "bigBed",
                "file_format_type": ["idr_peak"]
           },
          "TSSs": {
                "tag": "AZTSS",
                "visibility": "hide",
                "spectrum": "on",
                "type": "bigBed",
                "file_format_type": ["tss_peak"]
            },
            "Signal of unique reads": {
                "tag": "SIGBL",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of unique reads" ]
            },
            "Signal of all reads": {
                "tag": "SIGBM",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of all reads" ]
            },
            "Plus signal of unique reads": {
                "tag": "SIGLF",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of unique reads" ]
            },
            "Minus signal of unique reads": {
                "tag": "SIGLR",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of unique reads" ]
            },
            "Plus signal of all reads": {
                "tag": "SIGMF",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of all reads" ]
            },
            "Minus signal of all reads": {
                "tag": "SIGMR",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of all reads" ]
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY", "Replicates": "dimA" },
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}",
                        "combined_title": "Pooled"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"miRNA": { # MICRORNA_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' in ['microRNA-seq','microRNA counts']",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE microRNA experiments",
        "shortLabel": "ENCODE microRNA"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Replicates", "Views", "Assay" ],
    "Views": {
        "tag": "view",
        "group_order": [ "microRNA quantifications", "Plus signal of unique reads", "Minus signal of unique reads", "Plus signal of all reads" ,  "Minus signal of all reads"],
        "groups": {
            "microRNA quantifications": {
                "tag": "QUANT",
                "visibility": "dense",
                "type": "bigBed",
                "useScore": "0",
                "output_type": [ "microRNA quantifications" ]
            },
            "Plus signal of unique reads": {
                "tag": "SIGLF",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of unique reads" ]
            },
            "Minus signal of unique reads": {
                "tag": "SIGLR",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of unique reads" ]
            },
            "Plus signal of all reads": {
                "tag": "SIGMF",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "plus strand signal of all reads" ]
            },
            "Minus signal of all reads": {
                "tag": "SIGMR",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "negateValues": "on",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "minus strand signal of all reads" ]
            }
        }
    },
    "other_groups": {
        "dimensions": { "Biosample": "dimY", "Assay": "dimX", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "group_order": "sort",
                "groups": {
                "replicate": {
                    "title_mask": "Replicate_{replicate_number}", # Optional
                    #"tag_mask": "{replicate}", # Implicit
                    "combined_title": "Pooled" # "Combined"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Assay": {
                "tag": "ASSAY",
                "group_order": ["microRNA counts", "microRNA-seq"],
                "groups": { "one": { "title_mask": "{assay_term_name}" } }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"DNASE": { # DNASE_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' == 'DNase-seq'",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE DNase-HS experiments",
        "shortLabel": "ENCODE DNase-HS"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Signal", "Peaks", "Hotspots" ],
        "groups": {
            "Signal": {
                "tag": "aSIG",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of unique reads" ]
            },
            "Peaks": {
                "tag": "bPKS",
                "visibility": "hide",
                "type": "bigBed",
                "spectrum": "on",
                "scoreFilter": "100",
                "output_type": [ "peaks" ]
            },
            "Hotspots": {
                "tag": "cHOT",
                "visibility": "hide",
                "type": "bigBed",
                "spectrum": "on",
                "output_type": [ "hotspots" ]
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY", "Replicates": "dimA" },
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}",
                        "combined_title": "Pooled"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"WGBS": { # WGBS_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' in ['whole-genome shotgun bisulfite sequencing','shotgun bisulfite-seq assay','RRBS']",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE WGBS experiments",
        "shortLabel": "ENCODE WGBS"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Optimal IDR thresholded peaks", "Conservative IDR thresholded peaks",
                        "Replicated peaks", "Peaks",  "Signal" ],
        "groups": {
            "Optimal IDR thresholded peaks": {
                "tag": "aOIDR",
                "visibility": "dense",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "spectrum":"on",
                "scoreFilter":"0:1000",
                "output_type": [ "optimal idr thresholded peaks" ]
            },
            "Conservative IDR thresholded peaks": {
                "tag": "bCIDR",
                "visibility": "hide",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "spectrum":"on",
                "scoreFilter": "0:1000",
                "output_type": [ "conservative idr thresholded peaks" ]
            },
            "Replicated peaks": {
                "tag": "cRPKS",
                "visibility": "dense",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "spectrum":"on",
                "scoreFilter": "0:1000",
                "output_type": [ "replicated peaks" ]
            },
            "Peaks": {
                "tag": "dPKS",
                "visibility": "hide",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "scoreFilter": "0:1000",
                "output_type": [ "peaks" ]
            },
            "Signal": {
                "tag": "eSIG",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal" ]
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY","Targets": "dimX","Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}",
                        "combined_title": "Pooled"  #We only want pooled replicates on
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "{target} {assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"ChIP": { # CHIP_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' == 'ChIP-seq'",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE ChIP-seq experiments",
        "shortLabel": "ENCODE ChIP-seq"
    },
    "longLabel":  "{target} {assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{target} {assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Optimal IDR thresholded peaks", "Conservative IDR thresholded peaks",
                        "Replicated peaks", "Peaks",  "Fold change over control", "Signal p-value", "Signal" ],
        "groups": {
            "Optimal IDR thresholded peaks": {
                "tag": "aOIDR",
                "visibility": "dense",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "spectrum":"on",
                "scoreFilter": "100:1000",
                "output_type": [ "optimal idr thresholded peaks" ]
            },
            "Conservative IDR thresholded peaks": {
                "tag": "bCIDR",
                "visibility": "hide",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "spectrum":"on",
                "scoreFilter": "0:1000",
                "output_type": [ "conservative idr thresholded peaks" ]
            },
            "Replicated peaks": {
                "tag": "cRPKS",
                "visibility": "dense",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "spectrum":"on",
                "scoreFilter": "0:1000",
                "output_type": [ "replicated peaks" ]
            },
            "Peaks": {
                "tag": "dPKS",
                "visibility": "hide",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "scoreFilter": "0",
                "output_type": [ "peaks" ]
                # Tim, how complicated would it be to exclude "peaks" if other files are there?
            },
            "Fold change over control": {
                "tag": "eFCOC",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:10",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "fold change over control" ]
            },
            "Signal p-value": {
                "tag": "fSPV",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:10",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal p-value" ]
            },
            "Signal": {
                "tag": "gSIG",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:10",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal","signal of unique reads" ]
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY","Targets": "dimX","Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}", # Optional
                        "combined_title": "Pooled" # "Combined"
                         #We only want pooled replicates on
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}", "url_mask": "targets/{target.name}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "{target} {assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},


"eCLIP": { # ECLIP_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' == 'eCLIP'",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE eCLIP experiments",
        "shortLabel": "ENCODE eCLIP"
    },
    "longLabel":  "{target} {assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{target} {assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Signal", "Peaks" ],
        "groups": {
            "Signal": {
                "tag": "aSIG",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "autoScale": "off",
                "maxHeightPixels": "32:16:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal" ]
            },
            "Peaks": {
                "tag": "bPKS",
                "visibility": "dense",
                "type": "bigBed",
                "spectrum": "on",
                "scoreFilter": "100",
                "output_type": [ "peaks" ]
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY","Targets": "dimX","Replicates": "dimA" },
        "dimensionAchecked": "all",
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}",
                        "combined_title": "Pooled"
                         #We only want pooled replicates on
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}", "url_mask": "targets/{target.name}" } }
            }
        }
    },
    "file_defs": {
        "longLabel": "{target} {assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{target} {replicate}"
    }
},

"ANNO": { # ANNO_COMPOSITE_VIS_DEFS = {
    "rule": "'{@id}'.startswith('/annotations/')",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE annotations",
        "shortLabel": "ENCODE annotations"
    },
    "longLabel":  "Encyclopedia annotation of {annotation_type} for {biosample_term_name|multiple} - {accession}", #blank means "multiple biosamples"
    "shortLabel": "{annotation_type} of {biosample_term_name|multiple} {accession}", #blank means "multiple biosamples" not unknown
    "sortOrder": [ "Biosample","Replicates", "Views" ],
    "Views":  {
        "tag": "view",
        "group_order": [ "Candidate enhancers", "Candidate promoters",  "Chromatin state", "Peaks" ],
        "groups": {

            "Candidate enhancers": {
                "tag": "aENHAN",
                "type": "bigBed",
                "visibility": "dense",
                "output_type": [ "candidate enhancers" ]
            },
            "Candidate promoters": {
                "tag": "bPROMO",
                "type": "bigBed",
                "visibility": "dense",
                "output_type": [ "candidate promoters" ]
            },
            "Chromatin state": {
                "tag": "cSTATE",
                "type": "bigBed",
                "visibility": "dense",
                "output_type": [ "semi-automated genome annotation" ]
            },
            "Peaks": {
                "tag": "sPKS",
                "visibility": "hide",
                "type": "bigBed",
                "file_format_type": [ "narrowPeak" ],
                "scoreFilter": "0:1000",
                "output_type": [ "peaks" ]
            }
        }
    },
    "other_groups":  {
        "dimensions": { "Biosample": "dimY","Replicates": "dimA" },
        "dimensionAchecked": "all", # or "first"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "groups": {
                    "replicate": {
                        "title_mask": "Replicate_{replicate_number}", # Optional
                        "combined_title": "Pooled" # "Combined"
                         #We only want pooled replicates on
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "Encyclopedia annotation of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"ChIA": { # CHIA_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' == 'ChIA-PET'",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE ChIA-PET experiments",
        "shortLabel": "ENCODE ChIA-PET"
    },
    "longLabel":  "{target} {assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{target} {assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views": {
        "tag": "view",
        "group_order": [ "Signal of unique reads", "Signal of all reads" ],
        "groups": {
            "Signal of unique reads": {
                "tag": "SIGBL",
                "visibility": "full",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of unique reads" ]
            },
            "Signal of all reads": {
                "tag": "SIGBM",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "signal of all reads" ]
            }
        }
    },
    "other_groups": {
        "dimensions": { "Biosample": "dimY", "Targets": "dimX", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "group_order": "sort",
                "groups": {
                "replicate": {
                    "title_mask": "Replicate_{replicate_number}", # Optional
                    "combined_title": "Pooled" # "Combined"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            },
            "Targets": {
                "tag": "TARG",
                "groups": { "one": { "title_mask": "{target.label}" } }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
},

"HiC": { # HIC_COMPOSITE_VIS_DEFS = {
    "rule": "'{assay_term_name}' == 'HiC'",
    "assay_composite": {
        "longLabel":  "Collection of ENCODE Hi-C experiments",
        "shortLabel": "ENCODE HI-C"
    },
    "longLabel":  "{assay_title} of {replicates.library.biosample.summary} - {accession}",
    "shortLabel": "{assay_title} of {biosample_term_name} {accession}",
    "sortOrder": [ "Biosample", "Targets", "Replicates", "Views" ],
    "Views": {
        "tag": "view",
        "group_order": [ "Topologically associated domains", "Nested TADs", "Genome compartments" ],
        "groups": {
            "Topologically associated domains": {
                "tag": "aTADS",
                "visibility": "dense",
                "type": "bigBed 3+",
                "output_type": [ "topologically associated domains" ]
            },
            "Nested TADs": {
                "tag": "bTADS",
                "visibility": "hide",
                "type": "bigBed 3+",
                "output_type": [ "nested topologically associated domains" ]
            },
            "Genome compartments": {
                "tag": "cCOMPART",
                "visibility": "hide",
                "type": "bigWig",
                "viewLimits": "0:1",
                "transformFunc": "LOG",
                "autoScale": "off",
                "maxHeightPixels": "64:18:8",
                "windowingFunction": "mean+whiskers",
                "output_type": [ "genome compartments" ]
            }
        }
    },
    "other_groups": {
        "dimensions": { "Biosample": "dimY", "Replicates": "dimA" },
        "dimensionAchecked": "first", # or "all"
        "groups": {
            "Replicates": {
                "tag": "REP",
                "group_order": "sort",
                "groups": {
                "replicate": {
                    "title_mask": "Replicate_{replicate_number}", # Optional
                    "combined_title": "Pooled" # "Combined"
                    }
                }
            },
            "Biosample": {
                "tag": "BS",
                "groups": { "one": { "title_mask": "{biosample_term_name}"} }
            }
        }
    },
    "file_defs": {
        "longLabel": "{assay_title} of {biosample_term_name} {output_type} {replicate}",
        "shortLabel": "{replicate} {output_type_short_label}"
    }
}
}

#VIS_DEFS_BY_ASSAY = {
#    "LRNA":     LRNA_COMPOSITE_VIS_DEFS,
#    "tkRNA":    TKRNA_COMPOSITE_VIS_DEFS,
#    "SRNA":     SRNA_COMPOSITE_VIS_DEFS,
#    "TSS":      RAMPAGE_COMPOSITE_VIS_DEFS,
#    "miRNA":    MICRORNA_COMPOSITE_VIS_DEFS,
#    "DNASE":    DNASE_COMPOSITE_VIS_DEFS,
#    "WGBS":     WGBS_COMPOSITE_VIS_DEFS,
#    "ChIP":     CHIP_COMPOSITE_VIS_DEFS,
#    "eCLIP":    ECLIP_COMPOSITE_VIS_DEFS,
#    "ANNO":     ANNO_COMPOSITE_VIS_DEFS,
#    "ChIA":     CHIA_COMPOSITE_VIS_DEFS,
#    "HiC":      HIC_COMPOSITE_VIS_DEFS,
#    }

