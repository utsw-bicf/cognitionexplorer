{
    "title": "Consent",
    "description": "Schema for submitting a consent.",
    "id": "/profiles/consent.json",
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "identifyingProperties": ["uuid"],
    "additionalProperties": true,
    "mixinProperties": [
        { "$ref": "mixins.json#/schema_version" },
        { "$ref": "mixins.json#/uuid" },
        { "$ref": "mixins.json#/shared_status" },
        { "$ref": "mixins.json#/notes" },
        { "$ref": "mixins.json#/submitter_comment" }
    ],
    "required":["consent_type","patient","final_cons_sign","date_signed"],
    "properties": {
        "schema_version": {
            "default": "1"
        },
       

        "patient": {
            "title": "Patient",
            "description": "The patient the consent was for.",
            "type": "string",
            "linkTo": "Patient"
        },
       
        "date_signed": {
            "title": "Date Signed",
            "description": "Date of consent.",
            "type": "string",
            "anyOf": [
                {
                    "format": "date"
                }
            ]
        },
        "consent_type": {
            "title": "Consent Type",
            "description": "ver1 Doesn't include signature for release of genetic information (Version 1: 2007 - January 2011);ver2 Does include signature for release of genetic information (Version 2: February 2011 - February 2017);ver3 UTSTR Consent that has 2 signatures: (1) Full participation or Limited participation (limited is no future contact) and (2) Overall consent signature. This consent doesn't explicitly cover release of genetic information into a public repository. (we only have 1 of these in the database);ver4 UTSTR Consent that has 2 signatures: (1) Full participation or Limited participation (limited is no future contact) and (2) Overall consent signature. This consent explicitly covers release of genetic information into a public repository. (we only have 1 of these in the database);ver5 UTSTR consent that has 2 signatures; (1) optional biopsy signature and (2) overall consent signature (covers release of genetic information) (Version 5: February 2017 - early 2018);ver6 UTSTR consent that has only 1 signature for entire consent. This consent explicitly covers release of genetic information into a public repository (Version 6: early 2018 to present);Unknown;",
            "type": "string",
            "enum": [
                "1",
                "2",
                "3",
                "4",
                "5",
                "6",
                "Unknown"
            ]
        },
        "future_contact": {
            "title": "(1) Future Contact",
            "description": "",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        },
        "future_research": {
            "title": "(2) Future Research",
            "description": "",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        },
        "info_release": {
            "title": "(3) Info Release",
            "description": "",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        },
        "genetic_release": {
            "title": "(4) Genetic Release",
            "description": "",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        },
        "final_cons_sign": {
            "title": "(5) Final Consent Signature",
            "description": "",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        },
        "full_limited_part": {
            "title": "(6) Full or Limited Participation",
            "description": "Existed in version3 and version 4",
            "type": "string",
            "enum": [
                "Full",
                "Limited"
            ]
        },
        "opti_biopsy_sign": {
            "title": "(7) Optional Biopsy Signature",
            "description": "Existed in version5",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        },
        "scanned_consent": {
            "title": "Scanned Copy of Consent",
            "description": "",
            "type": "string",
            "enum": [
                "Y",
                "N"
            ]
        }
       },
    "oneOf": [
        {
            "properties": {
                "consent_version": {
                    "const": "1"
                }
            },
            "required": [
                "future_contact",
                "future_research",
                "info_release",
                "final_cons_sign"
            ],
            "allOf": [
                {
                    "not": {
                        "required": [
                            "genetic_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "full_limited_part"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "opti_biopsy_sign"
                        ]
                    }
                }]
        },
        {
            "properties": {
                "consent_version": {
                    "const": "2"
                }
            },
            "required": [
                "future_contact",
                "future_research",
                "info_release",
                "genetic_release",
                "final_cons_sign"],
            "allOf": [
                {
                    "not": {
                        "required": [
                            "full_limited_part"]
                    }
                },
                {
                    "not": {
                        "required": [
                            "opti_biopsy_sign"
                        ]
                    }
                }
            ]
        },
        {
            "properties": {
                "consent_version": {
                    "enum": [
                        "3",
                        "4"
                    ]
                }
            },
            "required": [
                "final_cons_sign",
                "full_limited_part"],
            "allOf": [
                {
                    "not": {
                        "required": [
                            "future_contact"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "future_research"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "info_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "genetic_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "opti_biopsy_sign"
                        ]
                    }
                }]
        },
        {
            "properties": {
                "consent_version": {
                    "const": "5"
                }
            },
            "required": [
                "final_cons_sign",
                "opti_biopsy_sign"],
            "allOf": [
                {
                    "not": {
                        "required": [
                            "future_contact"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "future_research"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "info_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "genetic_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "full_limited_part"
                        ]
                    }
                }]
        },
        {
            "properties": {
                "consent_version": {
                    "const": "6"
                }
            },
            "required": [
                "final_cons_sign"
            ],
            "allOf": [
                {
                    "not": {
                        "required": [
                            "future_contact"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "future_research"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "info_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "genetic_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "full_limited_part"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "opti_biopsy_sign"
                        ]
                    }
                }]
        },
        {
            "properties": {
                "consent_version": {
                    "const": "Unknown"
                }
            },
            
            "allOf": [
                {
                    "not": {
                        "required": [
                            "future_contact"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "future_research"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "info_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "genetic_release"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "final_cons_sign"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "full_limited_part"
                        ]
                    }
                },
                {
                    "not": {
                        "required": [
                            "opti_biopsy_sign"
                        ]
                    }
                }]
        }],
    "facets": {
        "status": {
            "title": "Status"
        }
    },
    "changelog": "/profiles/changelogs/consent.md"
 }
